الشرح
هيكل البيانات (Buffer):
هيكل المخزن الدائري يحتوي على حقول لتخزين البيانات في المخزن، مؤشرات للكتابة (in) والقراءة (out)، عدد العناصر في المخزن، مزامنة (mutex)، ومتغيرات شرطية (condition variables).
التهيئة والتنظيف:
init_buffer: تقوم هذه الدالة بتهيئة المؤشرات في المخزن، والمزامنة (mutex)، والمتغيرات الشرطية.
destroy_buffer: تقوم هذه الدالة بتحرير الموارد بعد انتهاء البرنامج.
المنتج (Producer):
يقوم المنتج بقفل المخزن (lock)، ويتحقق إذا كان المخزن ممتلئًا، وإذا كان الأمر كذلك، ينتظر حتى يكون هناك مكان.
بمجرد أن يكون هناك مساحة، يقوم بإدخال عنصر، تحديث المؤشرات، إرسال إشارة للمستهلك، ثم فتح المخزن (unlock).
المستهلك (Consumer):
يقوم المستهلك بقفل المخزن، ويتحقق إذا كان المخزن فارغًا، وإذا كان الأمر كذلك، ينتظر حتى يكون هناك عناصر.
عندما يكون هناك عنصر متاح، يستهلكه، يحدّث المؤشرات، يرسل إشارة للمنتج، ثم يفتح المخزن.
الدالة الرئيسية (Main):
تبدأ خيوط المنتج والمستهلك، تنتظر حتى تنتهي الخيوط، ثم تقوم بتنظيف الموارد.
التزامن:
تعمل هذه التنفيذات على تزامن الأنشطة بين المنتج والمستهلك باستخدام المزامنة (mutex) و المتغيرات الشرطية (condition variables)، مما يضمن الوصول الآمن إلى المخزن المشترك.






